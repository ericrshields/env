#!/bin/bash

# Project layer: Grafana
# Loaded when .env-marker-project-grafana exists
# Use for Grafana-specific development settings

# Increase JavaScript heap size to 10GB (needed for giant project like Grafana)
export NODE_OPTIONS="--max-old-space-size=10240"

# Grafana setup
export GF_DEFAULT_APP_MODE=development

export GOROOT=/usr/local/go
export GOPATH=$HOME/go
export PATH=$GOPATH/bin:$GOROOT/bin:$PATH

# Conditionally load work-specific SSH config
# Only when: work marker exists AND NOT on cloud
if [[ -f ~/env/.env-marker-work ]] && [[ ! -f ~/env/.env-marker-cloud ]]; then
    # Ensure SSH config directory exists
    mkdir -p ~/.ssh/config.d

    # Symlink work+grafana SSH config (use -f to update if source changed)
    if [[ ! -L ~/.ssh/config.d/work-grafana ]]; then
        ln -sf ~/env/ssh/configs/config-work-grafana ~/.ssh/config.d/work-grafana
        [[ "$VERBOSE_ENV_LOADING" == "true" ]] && echo "Linked: ~/.ssh/config.d/work-grafana"
    fi
fi